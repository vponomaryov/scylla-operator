


<!doctype html>
<html class="no-js" lang="en">
  
<head><!-- begin head.html -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>
    Deploying Scylla stack using Helm Charts | Scylla Docs
    </title>
    <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server."/>

    <link rel="icon" href="_static/img/favicon.ico" type="image/x-icon"/>
    <link rel="canonical" href="https://docs.scylladb.com/">

    <link rel="author" href="mailto:info@scylladb.com">
    <link rel="stylesheet" href="_static/" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_tabs/tabs.css" />
    
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/foundation.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/doc/main.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>

    <script src="_static/js/vendor/modernizr.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T8P2JP');</script>
    <!-- End Google Tag Manager -->

    <!-- Marketo -->
    <script type="text/javascript"> (function() { var didInit = false; function initMunchkin() { if(didInit === false) { didInit = true; Munchkin.init('791-QBF-350'); } } var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//munchkin.marketo.net/munchkin.js'; s.onreadystatechange = function() { if (this.readyState == 'complete' || this.readyState == 'loaded') { initMunchkin(); } }; s.onload = initMunchkin; document.getElementsByTagName('head')[0].appendChild(s); })(); </script>
    <!-- End Marketo -->

<!-- end head.html -->
</head>

<body>



<header id="header" class="animated">
    <div class="topbar_continer contain-to-grid clearfix">
        <nav class="top-bar" id="top-bar" data-topbar role="navigation">
            <ul class="title-area">
                <li class="name">
                    <div class="logo">
                        <a href="https://docs.scylladb.com/"><img src="_static/img/logo-scylla-docs.svg" alt="" width="151"></a>
                    </div>
                </li>
                <li class="toggle-topbar"><a href="#"><span class="icon-manu"></span></a></li>
            </ul>
            <section class="top-bar-section clearfix">
                <ul class="right">
                    
                    <li>
                        <a href="https://scylladb.github.io/scylla-operator/">Scylla Operator</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">Scylla Cloud</a>
                    </li>
                    
                    <li>
                        <a href="https://university.scylladb.com/">Scylla University</a>
                    </li>
                    
                    <li>
                        <a href="https://www.scylladb.com/">ScyllaDB Home</a>
                    </li>
                    
                    <li class="search_continer show-for-medium-up">	
                        <ci-search></ci-search>	
                    </li>	
                </ul>
            </section>
        </nav>
    </div>
</header>
<section id="content">
    <div class="row">
	
	<div class="large-6 large-push-3 columns">

        
        <div class="admonition caution">
            <p class="admonition-title">Caution</p>
            
            You are reading an unstable version of this documentation.
            
            If you want up-to-date information, please have a look at 
            <a href="../stable/index.html">
                    v1.0
            </a>.
        </div>
        

        <div class="section" id="deploying-scylla-stack-using-helm-charts">
<h1>Deploying Scylla stack using Helm Charts<a class="headerlink" href="#deploying-scylla-stack-using-helm-charts" title="Permalink to this headline">¶</a></h1>
<p>In this example we will install Scylla stack on Kubernetes. This includes the following components:</p>
<ul class="simple">
<li><p>Scylla Operator</p></li>
<li><p>Scylla Manager</p></li>
<li><p>Scylla</p></li>
</ul>
<p>We will use Minikube K8s cluster, but this could be any K8s cluster supported by the Scylla Operator.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Kubernetes 1.16+</p></li>
<li><p>Helm 3+</p></li>
</ul>
</div>
<div class="section" id="tl-dr">
<h2>TL;DR<a class="headerlink" href="#tl-dr" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">repo</span> <span class="n">add</span> <span class="n">scylla</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">scylla</span><span class="o">-</span><span class="n">operator</span><span class="o">-</span><span class="n">charts</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span>
<span class="n">helm</span> <span class="n">repo</span> <span class="n">update</span>
<span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="n">examples</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">cert</span><span class="o">-</span><span class="n">manager</span><span class="o">.</span><span class="n">yaml</span> 
<span class="n">helm</span> <span class="n">install</span> <span class="n">scylla</span><span class="o">-</span><span class="n">operator</span> <span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span><span class="o">-</span><span class="n">operator</span> <span class="o">--</span><span class="n">create</span><span class="o">-</span><span class="n">namespace</span> <span class="o">--</span><span class="n">namespace</span> <span class="n">scylla</span><span class="o">-</span><span class="n">operator</span>
<span class="n">helm</span> <span class="n">install</span> <span class="n">scylla</span><span class="o">-</span><span class="n">manager</span> <span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">create</span><span class="o">-</span><span class="n">namespace</span> <span class="o">--</span><span class="n">namespace</span> <span class="n">scylla</span><span class="o">-</span><span class="n">manager</span>
<span class="n">helm</span> <span class="n">install</span> <span class="n">scylla</span> <span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span> <span class="o">--</span><span class="n">create</span><span class="o">-</span><span class="n">namespace</span> <span class="o">--</span><span class="n">namespace</span> <span class="n">scylla</span>
</pre></div>
</div>
</div>
<div class="section" id="deploy-cert-manager">
<h2>Deploy Cert Manager<a class="headerlink" href="#deploy-cert-manager" title="Permalink to this headline">¶</a></h2>
<p>This step is optional if you want to use your own certificate.
If you don’t have one, make sure to not disable autogeneration using Scylla Operator Helm Chart.</p>
<p>First deploy Cert Manager, you can either follow <a class="reference external" href="https://cert-manager.io/docs/installation/kubernetes/">upsteam instructions</a> or use following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">kubectl apply -f examples/common/cert-manager.yaml</span>
</pre></div>
</div>
<p>Once it’s deployed, wait until all Cert Manager pods will enter into Running state:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">kubectl wait -n cert-manager --for=condition=ready pod -l app=cert-manager --timeout=60s</span>
</pre></div>
</div>
</div>
<div class="section" id="helm-chart-repository">
<h2>Helm Chart repository<a class="headerlink" href="#helm-chart-repository" title="Permalink to this headline">¶</a></h2>
<p>To install Scylla Helm Chart repository execute the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">repo</span> <span class="n">add</span> <span class="n">scylla</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">scylla</span><span class="o">-</span><span class="n">operator</span><span class="o">-</span><span class="n">charts</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span>
<span class="n">helm</span> <span class="n">repo</span> <span class="n">update</span>
</pre></div>
</div>
<p>Then you can search through repository, it should contain at least three Helm charts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">search</span> <span class="n">repo</span> <span class="n">scylla</span>
<span class="n">NAME</span>                   <span class="n">CHART</span> <span class="n">VERSION</span>   <span class="n">APP</span> <span class="n">VERSION</span>     <span class="n">DESCRIPTION</span>                                       
<span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span>          <span class="mf">1.0</span><span class="o">.</span><span class="mi">1</span>           <span class="n">v1</span><span class="o">.</span><span class="mf">0.1</span>          <span class="n">Scylla</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">close</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">hardware</span> <span class="n">rewrite</span> <span class="n">of</span> <span class="n">Ca</span><span class="o">...</span>
<span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span><span class="o">-</span><span class="n">manager</span>  <span class="mf">1.0</span><span class="o">.</span><span class="mi">1</span>           <span class="n">v1</span><span class="o">.</span><span class="mf">0.1</span>          <span class="n">Scylla</span> <span class="n">Manager</span> <span class="n">automates</span> <span class="n">database</span> <span class="n">operations</span><span class="o">.</span>     
<span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span><span class="o">-</span><span class="n">operator</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">1</span>           <span class="n">v1</span><span class="o">.</span><span class="mf">0.1</span>          <span class="n">Scylla</span> <span class="n">Operator</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">Kubernetes</span> <span class="n">Operator</span> <span class="k">for</span> <span class="n">ma</span><span class="o">...</span>
</pre></div>
</div>
<p>All these charts should be installable without any need of customizing (defaults are provided).
Although Helm is used for this particular reason, so lets customize them a bit.</p>
</div>
<div class="section" id="scylla-operator-chart">
<h2>Scylla Operator Chart<a class="headerlink" href="#scylla-operator-chart" title="Permalink to this headline">¶</a></h2>
<p>This chart is very simple, most interesting customizable fields are <code class="docutils literal notranslate"><span class="pre">image</span></code>, <code class="docutils literal notranslate"><span class="pre">resources</span></code> and <code class="docutils literal notranslate"><span class="pre">webhook</span></code>.
All others can be looked up in Chart source in Scylla Operator repository.</p>
<div class="section" id="image">
<h3>image<a class="headerlink" href="#image" title="Permalink to this headline">¶</a></h3>
<p>Image allows to define which Scylla Operator image will be used. By default it downloads the image from main
Docker Hub repository, using version defined in Helm Chart.
You can also change <code class="docutils literal notranslate"><span class="pre">pullPolicy</span></code> if default one does not
fullfill your needs. In <a class="reference external" href="https://kubernetes.io/docs/concepts/containers/images/">Kubernetes documentation</a> you
can read more about different pull policies.</p>
<p>Image URL will be composed based on these fields in follwing pattern:
<code class="docutils literal notranslate"><span class="pre">repository/scylla-operator:tag</span></code></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">repository</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scylladb</span>
  <span class="l l-Scalar l-Scalar-Plain">pullPolicy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
  <span class="l l-Scalar l-Scalar-Plain">tag</span><span class="p p-Indicator">:</span> <span class="s">&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="resources">
<h3>resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h3>
<p>You can customize how much resources will be allocated for Operator pods via <code class="docutils literal notranslate"><span class="pre">resource</span></code> field:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">limits</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">100m</span>
    <span class="l l-Scalar l-Scalar-Plain">memory</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">128Mi</span>
  <span class="l l-Scalar l-Scalar-Plain">requests</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">100m</span>
    <span class="l l-Scalar l-Scalar-Plain">memory</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">32Mi</span>
</pre></div>
</div>
<p>To read more about resource specification, follow <a class="reference external" href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">Kubernetes documentation</a>.</p>
</div>
<div class="section" id="webhook">
<h3>webhook<a class="headerlink" href="#webhook" title="Permalink to this headline">¶</a></h3>
<p>Webhook field allows to decide whether you want to use autogenerated self-signed certificate using Cert Manager or
whether you want to provide your own certificate.</p>
<p><code class="docutils literal notranslate"><span class="pre">createSelfSignedCertificate</span></code> specifies whether a self-signed certificate should be created using Cert Manager
<code class="docutils literal notranslate"><span class="pre">certificateSecretName</span></code>: name of a secret containing custom certificate.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">webhook</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">createSelfSignedCertificate</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="l l-Scalar l-Scalar-Plain">certificateSecretName</span><span class="p p-Indicator">:</span> <span class="s">&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="customization">
<h3>Customization<a class="headerlink" href="#customization" title="Permalink to this headline">¶</a></h3>
<p>You can customize all these fields and others by providing file containing desired values.
Content of this file will overwrite default values.</p>
<p>You can find an example in Scylla Operator repository under <code class="docutils literal notranslate"><span class="pre">examples/helm/values.operator.yaml</span></code></p>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>To deploy Scylla Operator using customized values file execute the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">install</span> <span class="n">scylla</span><span class="o">-</span><span class="n">operator</span> <span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span><span class="o">-</span><span class="n">operator</span> <span class="o">--</span><span class="n">values</span> <span class="n">examples</span><span class="o">/</span><span class="n">helm</span><span class="o">/</span><span class="n">values</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">create</span><span class="o">-</span><span class="n">namespace</span> <span class="o">--</span><span class="n">namespace</span> <span class="n">scylla</span><span class="o">-</span><span class="n">operator</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="scylla-helm-chart">
<h2>Scylla Helm Chart<a class="headerlink" href="#scylla-helm-chart" title="Permalink to this headline">¶</a></h2>
<p>Scylla Chart allows to customize and deploy Scylla cluster.
By default Scylla Helm charts deploys working Scylla cluster, but of course we can customize it.</p>
<div class="section" id="id1">
<h3>Customization<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Versions of images used in the cluster can be set via <code class="docutils literal notranslate"><span class="pre">scyllaImage</span></code> and <code class="docutils literal notranslate"><span class="pre">agentImage</span></code></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">scyllaImage</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">repository</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scylladb/scylla</span>
  <span class="l l-Scalar l-Scalar-Plain">tag</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">4.3.0</span>

<span class="l l-Scalar l-Scalar-Plain">agentImage</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">repository</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scylladb/scylla-manager-agent</span>
  <span class="l l-Scalar l-Scalar-Plain">tag</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">2.2.1</span>
</pre></div>
</div>
<p>A minimal Scylla cluster can be expressed as:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">datacenter</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="l l-Scalar l-Scalar-Plain">racks</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">us-east-1b</span>
  <span class="l l-Scalar l-Scalar-Plain">members</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
  <span class="l l-Scalar l-Scalar-Plain">storage</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">capacity</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">5G</span>
  <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">limits</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="l l-Scalar l-Scalar-Plain">memory</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1Gi</span>
    <span class="l l-Scalar l-Scalar-Plain">requests</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="l l-Scalar l-Scalar-Plain">memory</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1Gi</span>
</pre></div>
</div>
<p>Above cluster will use 4.3.0 Scylla, 2.2.1 Scylla Manager Agent sidecar and will have a single rack having 2 nodes.
Each node will have a single CPU and 1 GiB of memory.</p>
<p>For other customizable fields, please refer to <a class="reference internal" href="scylla_cluster_crd.html"><span class="doc">ScyllaCluster CRD definition</span></a>.
CRD Rack Spec and Helm Chart Rack should have the same fields.</p>
</div>
<div class="section" id="id2">
<h3>Installation<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>To deploy Scylla cluster using customzied values file execute the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">install</span> <span class="n">scylla</span> <span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span> <span class="o">--</span><span class="n">values</span> <span class="n">examples</span><span class="o">/</span><span class="n">helm</span><span class="o">/</span><span class="n">values</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">create</span><span class="o">-</span><span class="n">namespace</span> <span class="o">--</span><span class="n">namespace</span> <span class="n">scylla</span>
</pre></div>
</div>
<p>Scylla Operator will provision this cluster on your K8s environment.</p>
</div>
</div>
<div class="section" id="scylla-manager-helm-chart">
<h2>Scylla Manager Helm Chart<a class="headerlink" href="#scylla-manager-helm-chart" title="Permalink to this headline">¶</a></h2>
<p>Scylla Manager Chart allows to customize and deploy Scylla Manager in K8s environment.
Scylla Manager consist of two applications (Scylla Manager itself and Scylla Manager Controller) and additional Scylla cluster.</p>
<p>To read more about Scylla Manager see <a class="reference internal" href="manager.html"><span class="doc">Manager guide</span></a>.</p>
<div class="section" id="scylla-manager">
<h3>Scylla Manager<a class="headerlink" href="#scylla-manager" title="Permalink to this headline">¶</a></h3>
<p>To set version of used Scylla Manager you can use <code class="docutils literal notranslate"><span class="pre">image</span></code> field:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">repository</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scylladb</span>
  <span class="l l-Scalar l-Scalar-Plain">pullPolicy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
  <span class="l l-Scalar l-Scalar-Plain">tag</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">2.2.1</span>
</pre></div>
</div>
<p>To control how many resources are allocated for Scylla Manager use <code class="docutils literal notranslate"><span class="pre">resource</span></code> field:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">limits</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">500m</span>
    <span class="l l-Scalar l-Scalar-Plain">memory</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">500Mi</span>
  <span class="l l-Scalar l-Scalar-Plain">requests</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">500m</span>
    <span class="l l-Scalar l-Scalar-Plain">memory</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">500Mi</span>
</pre></div>
</div>
</div>
<div class="section" id="scylla-manager-controller">
<h3>Scylla Manager Controller<a class="headerlink" href="#scylla-manager-controller" title="Permalink to this headline">¶</a></h3>
<p>Similarly Scylla Manager Controller image can be customized:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">controllerImage</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">repository</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scylladb</span>
  <span class="l l-Scalar l-Scalar-Plain">pullPolicy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
  <span class="l l-Scalar l-Scalar-Plain">tag</span><span class="p p-Indicator">:</span> <span class="s">&quot;&quot;</span>
</pre></div>
</div>
<p>And allocated resources:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">controllerResources</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">limits</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">100m</span>
    <span class="l l-Scalar l-Scalar-Plain">memory</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">30Mi</span>
  <span class="l l-Scalar l-Scalar-Plain">requests</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">100m</span>
    <span class="l l-Scalar l-Scalar-Plain">memory</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">20Mi</span>
</pre></div>
</div>
</div>
<div class="section" id="scylla">
<h3>Scylla<a class="headerlink" href="#scylla" title="Permalink to this headline">¶</a></h3>
<p>To customize internal Scylla instance dedicated to Scylla Manager, see guide above customizing Scylla Helm Chart.
It’s definition should land as a <code class="docutils literal notranslate"><span class="pre">scylla</span></code> field.</p>
</div>
<div class="section" id="id3">
<h3>Customization<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>All others customizable fields can be looked up in Chart source in Scylla Operator repository.</p>
</div>
<div class="section" id="id4">
<h3>Installation<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>To deploy Scylla Manager using customized values file execute the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">install</span> <span class="n">scylla</span><span class="o">-</span><span class="n">manager</span> <span class="n">scylla</span><span class="o">/</span><span class="n">scylla</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">values</span> <span class="n">examples</span><span class="o">/</span><span class="n">helm</span><span class="o">/</span><span class="n">values</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">create</span><span class="o">-</span><span class="n">namespace</span> <span class="o">--</span><span class="n">namespace</span> <span class="n">scylla</span><span class="o">-</span><span class="n">manager</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>Scylla need some time to bootstrap all nodes, but after some time you should be ready to roll. It was simple isn’t it?
You can validate if everything was set up correctly by looking at the all resources created in used namespaces.</p>
<p>Scylla Operator:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl -n scylla-operator get all

NAME                    READY   STATUS    RESTARTS   AGE
pod/scylla-operator-0   <span class="m">1</span>/1     Running   <span class="m">0</span>          4m48s

NAME                      TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>   AGE
service/scylla-operator   ClusterIP   <span class="m">10</span>.43.231.78   &lt;none&gt;        <span class="m">443</span>/TCP   4m48s

NAME                               READY   AGE
statefulset.apps/scylla-operator   <span class="m">1</span>/1     4m48s
</pre></div>
</div>
<p>Operator is running!</p>
<p>Scylla Manager:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl -n scylla-manager get all 

NAME                                           READY   STATUS    RESTARTS   AGE
pod/scylla-manager-767b875bcf-7cppw            <span class="m">1</span>/1     Running   <span class="m">0</span>          7m
pod/scylla-manager-0                           <span class="m">1</span>/1     Running   <span class="m">0</span>          7m
pod/scylla-manager-manager-dc-manager-rack-0   <span class="m">2</span>/2     Running   <span class="m">0</span>          6m59s

NAME                                               TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>                                                           AGE
service/scylla-manager-manager-service             ClusterIP   <span class="m">10</span>.43.211.89    &lt;none&gt;        <span class="m">80</span>/TCP                                                            7m1s
service/scylla-manager-client                      ClusterIP   None            &lt;none&gt;        <span class="m">9180</span>/TCP,5090/TCP                                                 7m
service/scylla-manager-manager-dc-manager-rack-0   ClusterIP   <span class="m">10</span>.43.239.136   &lt;none&gt;        <span class="m">7000</span>/TCP,7001/TCP,7199/TCP,10001/TCP,9042/TCP,9142/TCP,9160/TCP   6m59s

NAME                             READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/scylla-manager   <span class="m">1</span>/1     <span class="m">1</span>            <span class="m">1</span>           7m1s

NAME                                        DESIRED   CURRENT   READY   AGE
replicaset.apps/scylla-manager-767b875bcf   <span class="m">1</span>         <span class="m">1</span>         <span class="m">1</span>       7m

NAME                                                      READY   AGE
statefulset.apps/scylla-manager                           <span class="m">1</span>/1     7m1s
statefulset.apps/scylla-manager-manager-dc-manager-rack   <span class="m">1</span>/1     7m
</pre></div>
</div>
<p>Good to go, ready to serve!</p>
<p>Scylla itself:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ kubectl -n scylla get all        

NAME                                READY   STATUS    RESTARTS   AGE
pod/scylla-us-east-1-us-east-1b-0   <span class="m">2</span>/2     Running   <span class="m">0</span>          5m58s
pod/scylla-us-east-1-us-east-1b-1   <span class="m">2</span>/2     Running   <span class="m">0</span>          4m29s

NAME                                    TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>                                                           AGE
service/scylla-client                   ClusterIP   None           &lt;none&gt;        <span class="m">9180</span>/TCP,5090/TCP                                                 5m59s
service/scylla-us-east-1-us-east-1b-0   ClusterIP   <span class="m">10</span>.43.149.92   &lt;none&gt;        <span class="m">7000</span>/TCP,7001/TCP,7199/TCP,10001/TCP,9042/TCP,9142/TCP,9160/TCP   5m58s
service/scylla-us-east-1-us-east-1b-1   ClusterIP   <span class="m">10</span>.43.49.0     &lt;none&gt;        <span class="m">7000</span>/TCP,7001/TCP,7199/TCP,10001/TCP,9042/TCP,9142/TCP,9160/TCP   4m29s

NAME                                           READY   AGE
statefulset.apps/scylla-us-east-1-us-east-1b   <span class="m">2</span>/2     5m59s
</pre></div>
</div>
<p>Two running nodes, exactly what we were asking for.</p>
</div>
<div class="section" id="monitoring">
<h2>Monitoring<a class="headerlink" href="#monitoring" title="Permalink to this headline">¶</a></h2>
<p>To spin up a Prometheus monitoring refer to <a class="reference internal" href="monitoring.html"><span class="doc">monitoring guide</span></a>.</p>
<p>Helm charts can create ServiceMonitors needed to observe Scylla Managger and Scylla.
Both of these Helm Charts allows to specify whether you want to create a ServiceMonitor:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">serviceMonitor</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">create</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>Change <code class="docutils literal notranslate"><span class="pre">create</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code> and update your current deployment using:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>helm upgrade --install scylla --namespace scylla scylla/scylla -f examples/helm/values.cluster.yaml
</pre></div>
</div>
<p>Helm should notice the difference, install the ServiceMonitor, and then Prometheous will be able to scrape metrics.</p>
</div>
<div class="section" id="cleanup">
<h2>Cleanup<a class="headerlink" href="#cleanup" title="Permalink to this headline">¶</a></h2>
<p>To remove these applications you can simply uninstall them using Helm CLI:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>helm uninstall scylla -n scylla
helm uninstall scylla-manager -n scylla-manager
helm uninstall scylla-operator -n scylla-operator
</pre></div>
</div>
</div>
</div>

        </div>

        <div id="sidebar" class="large-3 large-pull-6 columns"><div class="side-nav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="generic.html">Deploying Scylla on a Kubernetes Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="eks.html">Deploying Scylla on EKS (experimental)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gke.html">Deploying Scylla on GKE</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Deploying Scylla stack using Helm Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager.html">Deploying Scylla Manager on a Kubernetes Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring.html">Setting up Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="node_operations.html">Node operations using Scylla Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade.html">Upgrade of Scylla Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="scylla_cluster_crd.html">Scylla Cluster CRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to Scylla Operator</a></li>
</ul>

</div>
        </div>

        <div class="large-3 columns">
            
                <div class="versions-dropdown ">
    <button class="button">
	master

	 <i class="fa fa-caret-down" aria-hidden="true"></i>
    </button>
    <ul class="content">
            <li><a href="helm.html">master</a></li>
            <li><a href="../v0.3/index.html">v0.3</a></li>
            <li><a href="../stable/index.html">v1.0</a></li>
    </ul>
</div>
            
        </div>

    </div>
</section>

<!-- newsleter modal -->

<div id="newsletter_signup" class="reveal-modal tiny radius dark_modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
    <a class="close-reveal-modal" aria-label="Close">×</a>
    <h2 id="modalTitle">Sign up for the Scylla newsletter</h2>
    <div id="mc_embed_signup">
        <form action="//cloudius-systems.us10.list-manage.com/subscribe/post?u=df8bb543c68230d5f7b4dcf78&amp;id=9a4589f144" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
            <div id="mc_embed_signup_scroll">

                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-EMAIL">Email</label></div>
                        <div class="small-9 columns"><input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-FNAME">First Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="FNAME" class="" id="mce-FNAME"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-LNAME">Last Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="LNAME" class="" id="mce-LNAME"></div>
                    </div>
                </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_df8bb543c68230d5f7b4dcf78_9a4589f144" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" class="button" value="Sign up" name="subscribe" id="mc-embedded-subscribe"></div>
            </div>
        </form>
    </div>
</div>

<!-- end newsleter modal -->



<!-- footer.html -->
<footer id="footer">
    <div class="footer-top">
        <a class="logo" href="https://www.scylladb.com"><img src="_static/img/logo-scylla-horizontal-RGB.svg" alt=""></a>
        <div class="footer-links">
            <a class="link" href="https://docs.scylladb.com">Docs</a>
            <a class="link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
            <a class="link" href="https://www.scylladb.com/company/">About Us</a>
            <a class="link button" href="https://github.com/scylladb/scylla-operator/issues/new?title=Issue in page Deploying Scylla stack using Helm Charts&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://operator.docs.scylladb.com/master/helm%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix" target="_blank">
                Report an issue on this page</a>
        </div>
        <div class="footer-actions">
            <a class="link-icon" href="https://github.com/ScyllaDB" target="_blank">
                <span class="icon-github2"></span></a>
            <a class="link-icon" href="https://twitter.com/ScyllaDB" target="_blank">
                <span class="icon-twitter"></span></a>
            <a class="link-icon" href="https://www.linkedin.com/company/scylladb"  target="_blank">
                <span class="icon-linkedin2"></span></a>
            <a class="link-icon" href="https://www.facebook.com/scylladb/" target="_blank">
                <span class="icon-facebook"></span></a>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="footer-info">
            <div class="footer-copyright">
                &#169; 2021, ScyllaDB. All rights reserved.
            </div>
            <div class="footer-last-updated">
                Last updated on 10 February 2021.
            </div>
            <div class="footer-version">
                Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
                &amp; <a href="https://pypi.org/project/sphinx-scylladb-theme">ScyllaDB Theme 0.1.21</a>
            </div>
        </div>
        <div class="footer-links">
        </div>
    </div>
</footer>
<!-- end footer.html -->

<!-- bodyscripts.html -->
<!-- at the end of the BODY --> 
<script src="_static/js/vendor/jquery.js"></script>
<script src="_static/js/vendor/jquery.cookie.min.js"></script>
<script src="_static/expertrec.js"></script>
<script src="_static/js/foundation/foundation.js"></script>
<script src="_static/js/foundation/foundation.topbar.js"></script>
<script src="_static/app.js"></script>
<script>
    $(document).foundation();
</script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <!-- end bodyscripts.html -->
</body>
</html>